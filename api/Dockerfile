FROM oven/bun:alpine
ARG CLERK_SECRET_KEY
ENV CLERK_SECRET_KEY=$CLERK_SECRET_KEY
ARG ZERO_UPSTREAM_DB
ENV ZERO_UPSTREAM_DB=$ZERO_UPSTREAM_DB

USER bun
WORKDIR /app

COPY . .
RUN bun install --lockfile-only

ARG PORT
EXPOSE ${PORT:-3000}

CMD ["bun", "run", "prod:api"]
